insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Afghanistan 2007', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Seven or more' then 0 when answers.Q1='Five or six' then 4 when answers.Q1='Four' then 9 when answers.Q1='Three' then 12 when answers.Q1='Two' then 17 when answers.Q1='One' then 23 when answers.Q1='None' then 29 end + case when answers.Q2='No male head/spouse' then 0 when answers.Q2='No female head/spouse' then 5 when answers.Q2='No' then 5 when answers.Q2='Yes' then 11 end + case when answers.Q3='Temporary shelter/shack, part of a shared house, separate apartment, shared apartment, tent, or other' then 0 when answers.Q3='Single-family house' then 3 end + case when answers.Q4='One to four' then 0 when answers.Q4='Five or more' then 4 end + case when answers.Q5='None (open field, bush) or sahrahi, dearan (area inside or outside compound but not pit), or other' then 0 when answers.Q5='Open pit' then 5 when answers.Q5='Traditional covered latrine' then 6 when answers.Q5='Improved latrine, or flush latrine' then 11 end + case when answers.Q6='Animal dung, scavenged material/trash, bushes (ping)/twigs, branches, or other' then 0 when answers.Q6='Crop residues, firewood, charcoal/coal, kerosene or oil, gas, or electricity' then 4 end + case when answers.Q7='None' then 0 when answers.Q7='One' then 1 when answers.Q7='Two or more' then 9 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 3 end + case when answers.Q9='No' then 0 when answers.Q9='Motorcycle only' then 12 when answers.Q9='Car (regardless of motorcycle)' then 22 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 4 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_afghanistan_2007_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_afghanistan_2007_family_members_0_to_16', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_afghanistan_2007_male_female_head_can_read_write', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_afghanistan_2007_dwelling_type', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_afghanistan_2007_rooms_for_family', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_afghanistan_2007_toilet_type', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_afghanistan_2007_cooking_fuel', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_afghanistan_2007_owns_stove', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_afghanistan_2007_owns_sewing_machine', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_afghanistan_2007_owns_motorcycle_car', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_afghanistan_2007_land_owned', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Afghanistan 2007' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Bangladesh 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Four or more' then 0 when answers.Q1='Three' then 9 when answers.Q1='Two' then 12 when answers.Q1='One' then 19 when answers.Q1='None' then 31 end + case when answers.Q2='Yes' then 0 when answers.Q2='No' then 10 end + case when answers.Q3='Open field' then 0 when answers.Q3='Kacha latrine (temporary or permanent), pacca (pit or water seal), or sanitary' then 5 end + case when answers.Q4='One, two, or three' then 0 when answers.Q4='Four' then 7 when answers.Q4='Five or more' then 11 end + case when answers.Q5='Mud brick, hemp/hay/ bamboo, or other' then 0 when answers.Q5='C.I. sheet/wood' then 2 when answers.Q5='Brick/cement' then 8 end + case when answers.Q6='Tile/wood, hemp/hay/ bamboo, or other' then 0 when answers.Q6='C.I. sheet/wood' then 2 when answers.Q6='Cement' then 13 end + case when answers.Q7='None, or less than 0.5 acres' then 0 when answers.Q7='More than 0.5 acres, but less than 1 acre' then 4 when answers.Q7='More than 1 acre' then 6 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 7 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 5 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 4 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_bangladesh_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_bangladesh_2009_family_members_0_to_11', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_bangladesh_2009_daily_wage_earner', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_bangladesh_2009_latrine_type', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_bangladesh_2009_rooms_for_family', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_bangladesh_2009_house_walls', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_bangladesh_2009_house_roof', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_bangladesh_2009_land_owned', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_bangladesh_2009_owns_television', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_bangladesh_2009_owns_cassette_player', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_bangladesh_2009_owns_wristwatch', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Bangladesh 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Benin 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Littoral' then 0 when answers.Q1='Mono' then 1 when answers.Q1='Zou, Atlantique, or Collines' then 3 when answers.Q1='Couffo' then 4 when answers.Q1='Plateau' then 7 when answers.Q1='Ou?m?' then 11 when answers.Q1='Donga, or Borgou' then 12 when answers.Q1='Alibori' then 13 when answers.Q1='Atakora' then 14 end + case when answers.Q2='Earth, stone, wood/planks, palm leaves/bamboo, or other' then 0 when answers.Q2='Mud plastered with cement' then 1 when answers.Q2='Bricks' then 4 end + case when answers.Q3='Eight or more' then 0 when answers.Q3='Seven' then 6 when answers.Q3='Six' then 10 when answers.Q3='Five' then 14 when answers.Q3='Four' then 20 when answers.Q3='Three' then 30 when answers.Q3='Two' then 40 when answers.Q3='One' then 48 end + case when answers.Q4='No' then 0 when answers.Q4='Yes' then 3 when answers.Q4='There is no female head/spouse' then 3 end + case when answers.Q5='Kerosene' then 0 when answers.Q5='Electricity, LPG, oil, solar energy, electric generator (community or private), or other' then 4 end + case when answers.Q6='One' then 0 when answers.Q6='Two' then 2 when answers.Q6='Three or more' then 5 end + case when answers.Q7='Firewood, or straw' then 0 when answers.Q7='Charcoal, electricity, LPG, kerosene, or other' then 3 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 5 end + case when answers.Q9='None' then 0 when answers.Q9='One' then 2 when answers.Q9='Two or more' then 9 end + case when answers.Q10='Does not own etc.' then 0 when answers.Q10='Does own etc., but land is not sub-divided, developed, or irrigated' then 2 when answers.Q10='Does own etc., and some land is sub-divided, developed, or irrigated' then 5 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_department', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_main_exterior_wall_material', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_family_members', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_female_head_can_read_french', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_lighting_fuel', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_sleeping_rooms', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_cooking_fuel', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_owns_car_motorcycle', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_phones', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_benin_2010_land_owned', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Benin 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Bolivia 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Seven or more' then 0 when answers.Q1='Six' then 7 when answers.Q1='Five' then 11 when answers.Q1='Four' then 16 when answers.Q1='Three' then 17 when answers.Q1='Two' then 26 when answers.Q1='One' then 35 end + case when answers.Q2='Not all' then 0 when answers.Q2='All' then 2 when answers.Q2='No children ages 6 to 17' then 4 end + case when answers.Q3='Earth, bricks, or other' then 0 when answers.Q3='Wooden planks, cement, hardwood floors, parquet, rugs or carpets' then 4 when answers.Q3='Tile (mosaic, stone, or ceramic)' then 10 end + case when answers.Q4='Firewood, dung/manure, kerosene, LPG in a cylinder, or other' then 0 when answers.Q4='Piped-in natural gas, electricity, or does not cook' then 7 end + case when answers.Q5='No' then 0 when answers.Q5='Yes' then 5 end + case when answers.Q6='No' then 0 when answers.Q6='Yes' then 5 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 10 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 6 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 5 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 13 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_bolivia_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_bolivia_2009_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_bolivia_2009_family_members_6_10_17_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_bolivia_2009_house_floors', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_bolivia_2009_cooking_fuel', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_bolivia_2009_has_refrigerator_or_freezer', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_bolivia_2009_has_dining_table_and_chairs', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_bolivia_2009_has_television', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_bolivia_2009_has_vcr_or_dvd', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_bolivia_2009_has_stereo', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_bolivia_2009_blue_or_white_collar_job', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Bolivia 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Brazil 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Five or more' then 0 when answers.Q1='Four' then 6 when answers.Q1='Three' then 11 when answers.Q1='Two' then 17 when answers.Q1='One' then 20 end + case when answers.Q2='No' then 0 when answers.Q2='Yes' then 5 when answers.Q2='No members ages 5 to 18' then 7 end + case when answers.Q3='Three or less' then 0 when answers.Q3='Four to eleven' then 2 when answers.Q3='Twelve or more' then 8 when answers.Q3='No female head/spouse' then 8 end + case when answers.Q4='None' then 0 when answers.Q4='One' then 4 when answers.Q4='Two or more' then 13 end + case when answers.Q5='None' then 0 when answers.Q5='One or more' then 8 end + case when answers.Q6='One to four' then 0 when answers.Q6='Five' then 2 when answers.Q6='Six' then 5 when answers.Q6='Seven' then 7 when answers.Q6='Eight or more' then 11 end + case when answers.Q7='Ditch, other, or no bathroom' then 0 when answers.Q7='Simple hole, or directly into river, lake, or ocean' then 2 when answers.Q7='Septic tank not connected to public sewage/rainwater system' then 3 when answers.Q7='Septic tank connected to public sewage/rainwater system' then 4 when answers.Q7='Direct connection to public sewage/rainwater system' then 5 end + case when answers.Q8='No' then 0 when answers.Q8='Yes, with one door' then 5 when answers.Q8='Yes, with two doors' then 10 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 7 end + case when answers.Q10='None' then 0 when answers.Q10='Cellular but not land-line' then 5 when answers.Q10='Land-line but not cellular' then 6 when answers.Q10='Both' then 11 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_brazil_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_brazil_2010_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_brazil_2010_family_members_5_to_18_in_private_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_brazil_2010_years_of_school_for_female_head', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_brazil_2010_empoyed_with_contract', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_brazil_2010_employed_at_mid_level', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_brazil_2010_rooms_in_house', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_brazil_2010_sewage_disposal', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_brazil_2010_has_refrigerator', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_brazil_2010_has_washing_machine', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_brazil_2010_has_phone', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Brazil 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Burkinafaso 2011', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Six or more' then 0 when answers.Q1='Five' then 5 when answers.Q1='Four' then 6 when answers.Q1='Three' then 10 when answers.Q1='Two' then 13 when answers.Q1='One' then 19 when answers.Q1='None' then 29 end + case when answers.Q2='None, or no male head/spouse' then 0 when answers.Q2='French only' then 4 when answers.Q2='A non-French language (regardless of French literacy)' then 5 end + case when answers.Q3='No' then 0 when answers.Q3='No female head/spouse' then 0 when answers.Q3='Yes' then 9 end + case when answers.Q4='Firewood, or other' then 0 when answers.Q4='Candles, kerosene, or LPG' then 4 when answers.Q4='Flashlight, or batteries' then 5 when answers.Q4='Electricity, or solar energy' then 8 end + case when answers.Q5='No toilet arrangement, or other' then 0 when answers.Q5='Non-ventilated pit latrine' then 4 when answers.Q5='Ventilated pit latrine, or flush to a septic tank' then 15 end + case when answers.Q6='No' then 0 when answers.Q6='Yes' then 10 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 3 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 6 end + case when answers.Q9='Yes' then 0 when answers.Q9='No' then 8 end + case when answers.Q10='None, or one' then 0 when answers.Q10='Two' then 2 when answers.Q10='Three to five' then 3 when answers.Q10='Six or more' then 7 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_burkinafaso_2011_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_burkinafaso_2011_family_members_0_to_14', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_burkinafaso_2011_male_head_read_write_languages', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_burkinafaso_2011_female_head_first_gradel', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_burkinafaso_2011_lighting_fuel', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_burkinafaso_2011_toilet_type', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_burkinafaso_2011_owns_television', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_burkinafaso_2011_owns_mattress_or_bed', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_burkinafaso_2011_owns_scooter_motorcycle', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_burkinafaso_2011_family_members_worked_last_week', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_burkinafaso_2011_cattle_owned', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Burkinafaso 2011' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Cambodia 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Eight or more' then 0 when answers.Q1='Seven' then 2 when answers.Q1='Six' then 6 when answers.Q1='Five' then 10 when answers.Q1='Four' then 14 when answers.Q1='Three' then 19 when answers.Q1='One or two' then 27 end + case when answers.Q2='Not all' then 0 when answers.Q2='All, or no children ages 7 to 15' then 4 end + case when answers.Q3='Bamboo or thatch, makeshift, salvaged, or improvised materials, other, or no data' then 0 when answers.Q3='Wood or logs, plywood, galvanized iron or aluminum, or fibrous cement' then 2 when answers.Q3='Concrete, brick, or stone' then 14 end + case when answers.Q4='Firewood or other' then 0 when answers.Q4='Charcoal, firewood and charcoal, liquefied petroleum gas, kerosene, publicly-provided electricity, gas and electricity, privately-generated electricity, or none/does not cook' then 6 end + case when answers.Q5='Open land' then 0 when answers.Q5='None' then 4 when answers.Q5='Pit latrine, septic tank, other without septic tank, public toilet, shared toilet, or other' then 6 when answers.Q5='Connected to sewerage' then 13 end + case when answers.Q6='No bicycles, and no motorcycles' then 0 when answers.Q6='One bicycle, and no motorcycles' then 4 when answers.Q6='Two bicycles, and no motorcycles' then 7 when answers.Q6='Three or more bicycles, and no motorcycles' then 11 when answers.Q6='One or more motorcycles (regardless of bicycles)' then 13 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 4 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 8 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 5 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 6 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_cambodia_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_cambodia_2009_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_cambodia_2009_family_members_7_to_15_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_cambodia_2009_house_walls', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_cambodia_2009_cooking_fuel', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_cambodia_2009_toilet_type', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_cambodia_2009_bicycles_and_motorcycles', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_cambodia_2009_owns_bed_set', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_cambodia_2009_owns_wardrobe', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_cambodia_2009_owns_water_pump', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_cambodia_2009_owns_television', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Cambodia 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Colombia 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Four or more' then 0 when answers.Q1='Three' then 5 when answers.Q1='Two' then 11 when answers.Q1='One' then 17 when answers.Q1='None' then 23 end + case when answers.Q2='None, or pre-school' then 0 when answers.Q2='Primary or middle school' then 3 when answers.Q2='High school' then 6 when answers.Q2='No female head/spouse' then 8 when answers.Q2='Post-secondary or college (1 to 4 years)' then 9 when answers.Q2='Post-secondary or college (5 years or more)' then 17 end + case when answers.Q3='None' then 0 when answers.Q3='One' then 9 when answers.Q3='Two or more' then 14 end + case when answers.Q4='None' then 0 when answers.Q4='One' then 4 when answers.Q4='Two or more' then 11 end + case when answers.Q5='No class or zero (no connection, pirated connection, or generator), one, or two' then 0 when answers.Q5='Three' then 4 when answers.Q5='Four, five, or six' then 9 end + case when answers.Q6='Firewood, wood, charcoal, coal, electricity, gasoline, petroleum, kerosene, alcohol, or waste material' then 0 when answers.Q6='LPG from a cylinder or tank' then 2 when answers.Q6='Natural gas from a public network' then 3 when answers.Q6='Does not cook' then 6 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 4 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 3 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 4 end + case when answers.Q10='None' then 0 when answers.Q10='Motorcycle only' then 3 when answers.Q10='Car (regardless of motorcycle)' then 9 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_colombia_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_colombia_2009_family_members_0_to_18', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_colombia_2009_female_head_education_level', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_colombia_2009_family_members_working_last_week', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_colombia_2009_family_members_employed', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_colombia_2009_electricity_class', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_colombia_2009_cooking_fuel', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_colombia_2009_owns_washing_machine', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_colombia_2009_owns_refrigerator', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_colombia_2009_owns_dvd', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_colombia_2009_owns_car_motorcycle', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Colombia 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Ecuador 2008', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Four or more' then 0 when answers.Q1='Three' then 10 when answers.Q1='Two' then 17 when answers.Q1='One' then 21 when answers.Q1='None' then 29 end + case when answers.Q2='No' then 0 when answers.Q2='No one in the age range' then 2 when answers.Q2='Yes' then 5 end + case when answers.Q3='Tile, palm leaves, straw, or leaves' then 0 when answers.Q3='Tin, asbestos (Eternit), or other' then 4 when answers.Q3='Reinforced concrete/flagstone/concrete' then 8 end + case when answers.Q4='None, latrine, flush toilet and pit, Flush toilet and septic tank not inside the residence' then 0 when answers.Q4='Flush toilet to sewer system not inside the residence' then 2 when answers.Q4='Flush toilet and septic tank inside the residence' then 4 when answers.Q4='Flush toilet to sewer system inside the residence' then 7 end + case when answers.Q5='No' then 0 when answers.Q5='Yes' then 5 end + case when answers.Q6='Firewood/charcoal or other' then 0 when answers.Q6='Gas, electricity, or no one cooks' then 4 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 18 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 6 end + case when answers.Q9='None' then 0 when answers.Q9='One' then 4 when answers.Q9='Two' then 9 when answers.Q9='Three or more' then 14 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 4 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_ecuador_2008_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_ecuador_2008_family_members_0_to_16', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_ecuador_2008_all_family_members_5_to_16_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_ecuador_2008_house_roof', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_ecuador_2008_toilet_type', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_ecuador_2008_has_shower', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_ecuador_2008_cooking_fuel', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_ecuador_2008_has_car', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_ecuador_2008_has_refrigerator', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_ecuador_2008_color_televisions', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_ecuador_2008_has_blender', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Ecuador 2008' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Egypt 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Seven or more' then 0 when answers.Q1='Six' then 5 when answers.Q1='Five' then 11 when answers.Q1='Four' then 18 when answers.Q1='Three' then 19 when answers.Q1='One or two' then 36 end + case when answers.Q2='No' then 0 when answers.Q2='Yes' then 2 when answers.Q2='No children 6 to 18' then 4 end + case when answers.Q3='No' then 0 when answers.Q3='No female head/spouse' then 4 when answers.Q3='Yes' then 7 end + case when answers.Q4='Yes' then 0 when answers.Q4='No' then 7 end + case when answers.Q5='Stones, mud, wood, tin, asbestos, or other' then 0 when answers.Q5='Bricks with mortar' then 4 when answers.Q5='Concrete' then 6 end + case when answers.Q6='One' then 0 when answers.Q6='Two' then 1 when answers.Q6='Three' then 2 when answers.Q6='Four or more' then 8 end + case when answers.Q7='Well, pump, public network with no connection, public network with tap outside building, or other' then 0 when answers.Q7='Public network with tap inside building' then 4 end + case when answers.Q8='No toilet available, or shared toilet' then 0 when answers.Q8='Private non-flush toilet' then 2 when answers.Q8='Private flush toilet' then 7 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 6 end + case when answers.Q10='No' then 0 when answers.Q10='Yes, only non-automatic' then 4 when answers.Q10='Yes, automatic' then 15 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_egypt_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_egypt_2010_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_egypt_2010_all_family_members_6_to_18_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_egypt_2010_female_head_literate', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_egypt_2010_has_temporary_wage_job', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_egypt_2010_house_walls', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_egypt_2010_rooms_in_house', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_egypt_2010_water_source', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_egypt_2010_toilet_type', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_egypt_2010_owns_gas_electric_water_heater', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_egypt_2010_owns_washing_machine', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Egypt 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Elsalvador 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Four or more' then 0 when answers.Q1='Three' then 5 when answers.Q1='Two' then 10 when answers.Q1='One' then 19 when answers.Q1='None' then 27 end + case when answers.Q2='One' then 0 when answers.Q2='Two' then 3 when answers.Q2='Three' then 4 when answers.Q2='Four' then 12 when answers.Q2='Five or more' then 15 end + case when answers.Q3='None' then 0 when answers.Q3='One' then 7 when answers.Q3='Two or more' then 18 end + case when answers.Q4='No' then 0 when answers.Q4='Yes' then 8 when answers.Q4='There is no female head/spouse' then 10 end + case when answers.Q5='Firewood, charcoal, kerosene, or other' then 0 when answers.Q5='Propane, electricity, or does not cook' then 7 end + case when answers.Q6='No' then 0 when answers.Q6='Yes' then 4 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 3 end + case when answers.Q8='None' then 0 when answers.Q8='Only a television' then 1 when answers.Q8='Both a television and a VCR or DVD' then 6 end + case when answers.Q9='None' then 0 when answers.Q9='Only a radio, or only a stereo system' then 1 when answers.Q9='Both a radio and a stereo system' then 4 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 6 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_elsalvador_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_elsalvador_2010_family_members_0_to_17', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_elsalvador_2010_rooms_in_house', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_elsalvador_2010_salaried_employees', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_elsalvador_2010_female_head_worked_last_week', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_elsalvador_2010_coking_fuel', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_elsalvador_2010_has_refrigerator', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_elsalvador_2010_has_blender', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_elsalvador_2010_has_vcr_or_dvd', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_elsalvador_2010_has_stereo', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_elsalvador_2010_has_fan', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Elsalvador 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Ethiopia 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Six or more' then 0 when answers.Q1='Five' then 10 when answers.Q1='Four' then 20 when answers.Q1='Three' then 28 when answers.Q1='Two or one' then 45 end + case when answers.Q2='No' then 0 when answers.Q2='Yes' then 1 when answers.Q2='No children ages 6 to 12' then 3 end + case when answers.Q3='One' then 0 when answers.Q3='Two' then 1 when answers.Q3='Three or more' then 5 end + case when answers.Q4='Wood and grass, mud and stone, or other' then 0 when answers.Q4='Wood and mud, reeds and bamboo, cement and stone, hollow blocks, or bricks' then 5 end + case when answers.Q5='Pit latrine (shared), field/forest, container (household utensils), or other' then 0 when answers.Q5='Pit latrine (private)' then 4 when answers.Q5='Flush toilet (private or shared)' then 9 end + case when answers.Q6='Mainly firewood (purchase or collected), animal dung, or other' then 0 when answers.Q6='Crop residue' then 3 when answers.Q6='Charcoal, kerosene, butane gas, electricity, or does not use fuel' then 5 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 5 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 6 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 5 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 10 end + case when answers.Q11='No' then 0 when answers.Q11='Yes' then 2 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_ethiopia_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_ethiopia_2009_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_ethiopia_2009_all_family_members_6_to_12_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_ethiopia_2009_rooms_in_house', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_ethiopia_2009_house_walls', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_ethiopia_2009_toilet_type', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_ethiopia_2009_cooking_fuel', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_ethiopia_2009_owns_mattress_or_bed', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_ethiopia_2009_owns_radio', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_ethiopia_2009_owns_watches_or_clocks', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_ethiopia_2009_owns_cattle_sheep_goats', qgr.response, NULL)) AS 'Q10', GROUP_CONCAT(if(q.nickname = 'ppi_ethiopia_2009_owns_jewelry', qgr.response, NULL)) AS 'Q11' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Ethiopia 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Ghana 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Seven or more' then 0 when answers.Q1='Six' then 6 when answers.Q1='Five' then 8 when answers.Q1='Four' then 11 when answers.Q1='Three' then 15 when answers.Q1='Two' then 23 when answers.Q1='One' then 31 end + case when answers.Q2='No' then 0 when answers.Q2='Yes, or no children ages 5 to 12' then 4 end + case when answers.Q3='No female head/spouse' then 0 when answers.Q3='None or pre-school' then 4 when answers.Q3='Primary or middle' then 7 when answers.Q3='Any JSS, SSS, S, L, U, or higher' then 10 end + case when answers.Q4='Male head/spouse has no job' then 0 when answers.Q4='Yes, main job is in agriculture' then 8 when answers.Q4='No, main job is not in agriculture' then 10 when answers.Q4='No male head/spouse' then 10 end + case when answers.Q5='Palm leaves/raffia/thatch, wood, mud bricks/earth, bamboo, or other' then 0 when answers.Q5='Corrugated iron sheets, cement/concrete, asbestos/slate, or roofing tiles' then 3 end + case when answers.Q6='Not electricity (mains)' then 0 when answers.Q6='Electricity (mains)' then 5 end + case when answers.Q7='Borehole, well (with pump or not, protected or not), or other' then 0 when answers.Q7='River/stream, rain water/spring, or dugout/pond/lake/dam' then 5 when answers.Q7='Indoor plumbing, inside standpipe, sachet/bottled water,  standpipe/tap (public or private outside), pipe in neighbors, water truck/tanker, or water vendor' then 7 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 10 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 6 end + case when answers.Q10='None' then 0 when answers.Q10='Only radio' then 2 when answers.Q10='Radio cassette but no record player nor 3-in-1 (regardless of radio)' then 6 when answers.Q10='Record player but no 3-in-1 (regardless of radio or cassette)' then 9 when answers.Q10='3-in-1 radio system (regardless of any others)' then 14 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_ghana_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_ghana_2010_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_ghana_2010_all_family_members_5_to_12_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_ghana_2010_female_head_highest_grade', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_ghana_2010_male_head_agriculture_job', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_ghana_2010_house_roof', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_ghana_2010_house_lighting', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_ghana_2010_water_source', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_ghana_2010_owns_stove', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_ghana_2010_owns_iron', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_ghana_2010_owns_radio', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Ghana 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Guatemala 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Cinco o m?s' then 0 when answers.Q1='Cuatro' then 10 when answers.Q1='Tres' then 12 when answers.Q1='Dos' then 17 when answers.Q1='Uno' then 23 when answers.Q1='Ninguno' then 33 end + case when answers.Q2='No' then 0 when answers.Q2='No hay ni?os de edades 7 a 13' then 2 when answers.Q2='S?' then 6 end + case when answers.Q3='No' then 0 when answers.Q3='S?' then 6 when answers.Q3='No hay jefa/esposa del hogar' then 9 end + case when answers.Q4='S?' then 0 when answers.Q4='No' then 5 end + case when answers.Q5='Tierra, madera, parqu? u otro' then 0 when answers.Q5='Ladrillo de barro o torta de cemento' then 3 when answers.Q5='Ladrillo de cemento' then 9 when answers.Q5='Ladrillo cer?mico' then 15 end + case when answers.Q6='No' then 0 when answers.Q6='S?' then 9 end + case when answers.Q7='No' then 0 when answers.Q7='S?' then 8 end + case when answers.Q8='S?' then 0 when answers.Q8='No' then 3 end + case when answers.Q9='No' then 0 when answers.Q9='S?' then 8 end + case when answers.Q10='No' then 0 when answers.Q10='S?' then 3 when answers.Q10='Nadie se dedica a la agricultura' then 4 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_family_members_0_to_13', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_all_family_members_7_to_13_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_female_head_literate', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_empoyed_as_casual_labor', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_house_floors', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_has_refrigerator', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_has_gas_electric_stove', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_has_stone_mill', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_has_electric_iron', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_guatemala_2010_enmployed_in_agriculature_or_animals', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Guatemala 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Haiti 2006', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Four or more' then 0 when answers.Q1='Three' then 3 when answers.Q1='Two' then 8 when answers.Q1='One' then 11 when answers.Q1='None' then 19 end + case when answers.Q2='No' then 0 when answers.Q2='Yes' then 3 when answers.Q2='No children ages 6–14' then 3 end + case when answers.Q3='Not Port-a-Prince' then 0 when answers.Q3='Port-a-Prince' then 15 end + case when answers.Q4='No' then 0 when answers.Q4='Yes' then 7 end + case when answers.Q5='Earth' then 0 when answers.Q5='Concrete or other' then 4 when answers.Q5='Ceramic or wood planks' then 12 end + case when answers.Q6='No' then 0 when answers.Q6='Yes' then 7 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 12 end + case when answers.Q8='None' then 2 when answers.Q8='One' then 0 when answers.Q8='Two or three' then 5 when answers.Q8='Four or more' then 11 end + case when answers.Q9='Straw, palm leaves, or other' then 0 when answers.Q9='Iron' then 4 when answers.Q9='Concrete' then 9 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 5 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_haiti_2006_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_haiti_2006_family_members_0_to_14', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_haiti_2006_all_family_members_6_to_14_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_haiti_2006_household_location', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_haiti_2006_owns_radio', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_haiti_2006_house_floors', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_haiti_2006_money_from_abroad', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_haiti_2006_salaried_employment', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_haiti_2006_how_many_plots', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_haiti_2006_house_roof', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_haiti_2006_owns_pigs', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Haiti 2006' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Honduras 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Five or more' then 0 when answers.Q1='Four' then 11 when answers.Q1='Three' then 14 when answers.Q1='Two' then 16 when answers.Q1='One' then 23 when answers.Q1='None' then 32 end + case when answers.Q2='None, pre-school, or literacy program' then 0 when answers.Q2='Primary school' then 6 when answers.Q2='No female head/spouse, common cycle, or no data' then 10 when answers.Q2='Diversified or higher' then 14 end + case when answers.Q3='No data or no main occupation' then 0 when answers.Q3='Farmer, rancher, agricultural worker, or no male head/spouse' then 9 when answers.Q3='Shop owner, salesperson, service worker, transport and storage operator, or worker in textiles, construction, mechanics, graphics, chemicals, food processing, etc.' then 11 when answers.Q3='Office worker, transportation operator, professional, technician, director, manager, administrator, or related job' then 16 end + case when answers.Q4='None' then 0 when answers.Q4='One' then 3 when answers.Q4='Two or more' then 10 end + case when answers.Q5='One' then 0 when answers.Q5='Two' then 1 when answers.Q5='Three' then 4 when answers.Q5='Four or more' then 5 end + case when answers.Q6='Dirt, other, or no data' then 0 when answers.Q6='Mud bricks, poured concrete, or wood' then 3 when answers.Q6='Cement bricks' then 4 when answers.Q6='Ceramic tile or granite' then 7 end + case when answers.Q7='Not public network' then 0 when answers.Q7='Public network' then 3 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 4 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 5 end + case when answers.Q10='No' then 0 when answers.Q10='Yes, without cable' then 2 when answers.Q10='Yes, with cable' then 4 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_honduras_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_honduras_2010_family_members_0_to_14', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_honduras_2010_female_head_education_level', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_honduras_2010_male_head_occupation', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_honduras_2010_family_members_salaried', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_honduras_2010_house_bedrooms', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_honduras_2010_house_floors', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_honduras_2010_water_source', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_honduras_2010_has_refrigerator', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_honduras_2010_has_stove', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_honduras_2010_has_television', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Honduras 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI India 2008', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Four or more' then 0 when answers.Q1='Three' then 7 when answers.Q1='Two' then 11 when answers.Q1='One' then 17 when answers.Q1='Zero' then 26 end + case when answers.Q2='No male head/spouse' then 0 when answers.Q2='Not literate, no formal school, or primary or below' then 0 when answers.Q2='Middle' then 3 when answers.Q2='Secondary or higher secondary' then 5 when answers.Q2='Diploma/certificate course, graduate, or postgraduate and above' then 7 end + case when answers.Q3='Labour (agricultural, casual, or other)' then 0 when answers.Q3='Self-employed (agriculture or non-agriculture), regular wage/salary-earning, or others' then 5 end + case when answers.Q4='Firewood and chips, dung cake, kerosene, charcoal, coke or coal, gobar gas, or others' then 0 when answers.Q4='LPG or electricity' then 3 when answers.Q4='No cooking arrangement' then 9 end + case when answers.Q5='No' then 0 when answers.Q5='Yes' then 5 end + case when answers.Q6='No, neither one' then 0 when answers.Q6='Yes, only one' then 4 when answers.Q6='Yes, both' then 9 end + case when answers.Q7='No, neither one' then 0 when answers.Q7='Yes, only a mobile' then 9 when answers.Q7='Yes, a landline, regardless of mobile' then 15 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 1 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 5 end + case when answers.Q10='No, none' then 0 when answers.Q10='Yes, bicycle only, no motorcycle/scooter, or car' then 1 when answers.Q10='Motorcycle/scooter, but no car (regardless of bicycle)' then 13 when answers.Q10='Motor car/jeep (regardless of others)' then 18 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_family_members_0_to_17', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_male_head_education_level', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_household_type', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_cooking_fuel', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_owns_casseroles_thermos_thermoware', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_owns_vcr_vcd_dvd', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_phones', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_owns_sewing_machine', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_onws_almirah', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_india_2008_owns_bicycle_scooter_car', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI India 2008' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Indonesia 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Six or more' then 0 when answers.Q1='Five' then 7 when answers.Q1='Four' then 13 when answers.Q1='Three' then 21 when answers.Q1='Two' then 26 when answers.Q1='One' then 37 end + case when answers.Q2='Not all, or no children aged 5 to 18' then 0 when answers.Q2='All' then 3 end + case when answers.Q3='None' then 0 when answers.Q3='One or two' then 6 when answers.Q3='Three' then 7 when answers.Q3='Four or more' then 10 end + case when answers.Q4='Public utilities retail, safe/unsafe well, safe/unsafe water spring, river, rain water, or other' then 0 when answers.Q4='Public utilities (in pipes), or drilled/pumped well' then 4 when answers.Q4='From manufacturing' then 9 end + case when answers.Q5='Toilet over water, hole in ground/river, no toilet, or no one uses bathroom facility' then 0 when answers.Q5='Flush/sitting toilet' then 5 end + case when answers.Q6='Earth/soil' then 0 when answers.Q6='Not earth/soil' then 6 end + case when answers.Q7='Bamboo, other, or does not have' then 0 when answers.Q7='Concrete, gypsum, wood, or asbestos' then 4 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 12 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 9 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 5 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_indonesia_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_indonesia_2009_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_indonesia_2009_family_members_5_to_18_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_indonesia_2009_11_and_up_worked_last_week', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_indonesia_2009_water_source', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_indonesia_2009_toilet_type', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_indonesia_2009_house_floors', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_indonesia_2009_house_ceiling', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_indonesia_2009_owns_refrigerator', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_indonesia_2009_owns_motorcycle', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_indonesia_2009_owns_television', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Indonesia 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Jordan 2011', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Nine or more' then 0 when answers.Q1='Eight' then 4 when answers.Q1='Seven' then 7 when answers.Q1='Six' then 13 when answers.Q1='Five' then 15 when answers.Q1='Four' then 23 when answers.Q1='Three' then 30 when answers.Q1='One or two' then 38 end + case when answers.Q2='None' then 0 when answers.Q2='One' then 1 when answers.Q2='Two' then 2 when answers.Q2='Three or more' then 3 end + case when answers.Q3='No' then 0 when answers.Q3='Yes' then 3 end + case when answers.Q4='One or two' then 0 when answers.Q4='Three' then 6 when answers.Q4='Four' then 7 when answers.Q4='Five' then 11 when answers.Q4='Six or more' then 18 end + case when answers.Q5='No' then 0 when answers.Q5='Yes' then 3 end + case when answers.Q6='No' then 0 when answers.Q6='Yes' then 3 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 5 end + case when answers.Q8='No' then 0 when answers.Q8='Only computer' then 3 when answers.Q8='Computer and internet' then 6 end + case when answers.Q9='None' then 0 when answers.Q9='One mobile, but no land-lines' then 6 when answers.Q9='One or more land-lines, but no mobile' then 7 when answers.Q9='One or more landlines, and one mobile' then 8 when answers.Q9='Two or more mobiles, but no land-lines' then 10 when answers.Q9='One or more landlines, and two or more mobiles' then 15 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 6 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_jordan_2011_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_jordan_2011_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_jordan_2011_family_members_worked_last_week', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_jordan_2011_employed_in_highly_skilled_work', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_jordan_2011_house_rooms', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_jordan_2011_owns_gas_stove_with_oven', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_jordan_2011_has_vacuum', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_jordan_2011_has_air_conditioner', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_jordan_2011_has_internet', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_jordan_2011_phones', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_jordan_2011_owns_car', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Jordan 2011' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Kenya 2008', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Nine or more' then 0 when answers.Q1='Seven or eight' then 5 when answers.Q1='Six' then 8 when answers.Q1='Five' then 12 when answers.Q1='Four' then 18 when answers.Q1='Three' then 22 when answers.Q1='One or two' then 32 end + case when answers.Q2='None, or pre-school' then 0 when answers.Q2='Primary standards 1 to 6' then 1 when answers.Q2='Primary standard 7' then 2 when answers.Q2='Primary standard 8, or secondary' then 6 when answers.Q2='No female head/spouse' then 6 when answers.Q2='Secondary form 4 or higher' then 11 end + case when answers.Q3='Does not work' then 0 when answers.Q3='No male head/spouse' then 3 when answers.Q3='Agriculture, hunting, forestry, fishing, mining, or quarrying' then 7 when answers.Q3='Any other' then 9 end + case when answers.Q4='One' then 0 when answers.Q4='Two' then 2 when answers.Q4='Three' then 5 when answers.Q4='Four or more' then 8 end + case when answers.Q5='Wood, earth, or other' then 0 when answers.Q5='Cement, or tiles' then 3 end + case when answers.Q6='Collected firewood, purchased firewood, grass, or dry cell (torch)' then 0 when answers.Q6='Paraffin, candles, biogas, or other' then 6 when answers.Q6='Electricity, solar, or gas' then 12 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 4 end + case when answers.Q8='None' then 0 when answers.Q8='One' then 2 when answers.Q8='Two or more' then 4 end + case when answers.Q9='None' then 0 when answers.Q9='One' then 6 when answers.Q9='Two or more' then 10 end + case when answers.Q10='None' then 0 when answers.Q10='One' then 3 when answers.Q10='Two or more' then 7 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_female_head_education_level', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_male_head_occupation', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_house_rooms', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_house_floors', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_lighting_fuel', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_owns_iron', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_mosquito_nets', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_towels', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_kenya_2008_frying_pans', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Kenya 2008' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Malawi 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Eight or more' then 0 when answers.Q1='Seven' then 4 when answers.Q1='Six' then 7 when answers.Q1='Five' then 11 when answers.Q1='Four' then 14 when answers.Q1='Three' then 20 when answers.Q1='Two' then 29 when answers.Q1='One' then 41 end + case when answers.Q2='Tradition' then 0 when answers.Q2='Semi-permanent' then 1 when answers.Q2='Permanent' then 4 end + case when answers.Q3='Communal standpipe; communal open, unprotected well; communal hand pump; lake/reservoir, river/spring, or other' then 0 when answers.Q3='Piped into dwelling; piped outside dwelling (personal); personal hand pump; protected spring; or personal open, unprotected well' then 7 end + case when answers.Q4='Collected firewood, crop residue, or animal waste' then 0 when answers.Q4='Purchased firewood' then 4 when answers.Q4='Paraffin, electricity, gas, charcoal, saw dust, or other' then 9 end + case when answers.Q5='Collected firewood, grass, or other' then 0 when answers.Q5='Paraffin' then 6 when answers.Q5='Purchased firewood, electricity, gas, battery/dry cell (torch), or candles' then 12 end + case when answers.Q6='No' then 0 when answers.Q6='Yes' then 4 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 4 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 5 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 7 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 7 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_malawi_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_malawi_2010_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_malawi_2010_family_members_in_agriculture', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_malawi_2010_water_source', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_malawi_2010_cooking_fuel', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_malawi_2010_lighting_fuel', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_malawi_2010_owns_lantern', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_malawi_2010_owns_furnature', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_malawi_2010_owns_bicycle_scooter_car', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_malawi_2010_owns_hifi', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_malawi_2010_owns_iron', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Malawi 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Mali 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Five or more' then 0 when answers.Q1='Four' then 10 when answers.Q1='Three' then 13 when answers.Q1='Two' then 15 when answers.Q1='One' then 17 when answers.Q1='None' then 25 end + case when answers.Q2='Three or more' then 0 when answers.Q2='Two' then 7 when answers.Q2='One or none' then 14 end + case when answers.Q3='Tile or thatch' then 0 when answers.Q3='Mud, corrugated metal sheets, concrete, or other' then 12 end + case when answers.Q4='Partly cement or others' then 0 when answers.Q4='Cement' then 7 end + case when answers.Q5='Surface water, non-modern well, drilled well, or others' then 0 when answers.Q5='Modern well' then 3 when answers.Q5='Public pump' then 6 when answers.Q5='Faucet tap' then 11 end + case when answers.Q6='Others' then 0 when answers.Q6='Latrine (private or shared with other households) or flush toilet (private inside, private outside, or shared with other households)' then 7 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 6 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 7 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 5 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 6 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_mali_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_mali_2010_family_members_0_to_11', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_mali_2010_employed_in_agriculture_animals', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_mali_2010_house_roof', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_mali_2010_house_walls', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_mali_2010_water_source', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_mali_2010_toilet_type', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_mali_2010_owns_television', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_mali_2010_owns_radio', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_mali_2010_owns_iron', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_mali_2010_owns_motorbike', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Mali 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Mexico 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Four or more' then 0 when answers.Q1='Three' then 7 when answers.Q1='Two' then 11 when answers.Q1='One' then 20 when answers.Q1='None' then 28 end + case when answers.Q2='None' then 0 when answers.Q2='Up to third grade' then 5 when answers.Q2='Fourth grade through high school' then 7 when answers.Q2='College preparatory 1 - 3' then 10 when answers.Q2='Normal/technical/commercial' then 14 when answers.Q2='Professional, master\\\'s or doctorate' then 20 when answers.Q2='No female head/spouse' then 14 end + case when answers.Q3='None' then 0 when answers.Q3='One' then 6 when answers.Q3='Two or more' then 16 end + case when answers.Q4='Dirt' then 0 when answers.Q4='Cement/concrete' then 2 when answers.Q4='Other' then 7 end + case when answers.Q5='No toilet, or no water supply' then 0 when answers.Q5='Carried by bucket' then 1 when answers.Q5='Piped' then 3 end + case when answers.Q6='No' then 0 when answers.Q6='Yes' then 4 end + case when answers.Q7='Firewood' then 0 when answers.Q7='Other' then 2 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 4 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 4 end + case when answers.Q10='None' then 0 when answers.Q10='One' then 0 when answers.Q10='Two' then 5 when answers.Q10='Three or more' then 12 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_mexico_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_mexico_2009_family_members_0_to_17', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_mexico_2009_female_head_education_level', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_mexico_2009_empoyed_with_contract', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_mexico_2009_house_floor', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_mexico_2009_toilet_water_supply', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_mexico_2009_has_sink_for_dishes', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_mexico_2009_cooking_fuel', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_mexico_2009_has_blender', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_mexico_2009_has_iron', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_mexico_2009_televisions', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Mexico 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Nepal 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Four or more' then 0 when answers.Q1='Three' then 6 when answers.Q1='Two' then 12 when answers.Q1='One' then 16 when answers.Q1='None' then 28 end + case when answers.Q2='Not all' then 0 when answers.Q2='No children ages 5 to 12' then 2 when answers.Q2='All' then 5 end + case when answers.Q3='No' then 0 when answers.Q3='Yes' then 8 end + case when answers.Q4='No' then 0 when answers.Q4='No female head/spouse' then 5 when answers.Q4='Yes' then 8 end + case when answers.Q5='Straw/thatch, wood/planks, earth/mud, or other' then 0 when answers.Q5='Tiles/slate' then 4 when answers.Q5='Galvanized iron, or concrete/cement' then 10 end + case when answers.Q6='No toilet' then 0 when answers.Q6='Household non-flush, communal latrine, household flush (connected to municipal sewer), or household flush (connected to septic tank)' then 7 end + case when answers.Q7='Open fireplace, other, or no data' then 0 when answers.Q7='Mud stove, smokeless stove, or kerosene/gas stove' then 5 end + case when answers.Q8='None' then 0 when answers.Q8='One' then 6 when answers.Q8='Two or more' then 13 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 5 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 11 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_nepal_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_nepal_2009_family_members_0_to_12', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_nepal_2009_family_members_5_to_12_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_nepal_2009_family_members_at_private_school', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_nepal_2009_female_head_can_read', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_nepal_2009_house_roof', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_nepal_2009_toilet_type', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_nepal_2009_stove_type', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_nepal_2009_music_players', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_nepal_2009_owns_transportation', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_nepal_2009_owns_television', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Nepal 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Nicaragua 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Eight or more' then 0 when answers.Q1='Seven' then 10 when answers.Q1='Six' then 12 when answers.Q1='Five' then 13 when answers.Q1='Four' then 19 when answers.Q1='Three' then 26 when answers.Q1='One or two' then 37 end + case when answers.Q2='Not all' then 0 when answers.Q2='All, and all are in a non-autonomous public school, community school, or other' then 1 when answers.Q2='All, and one is in autonomous or private school' then 3 when answers.Q2='No children ages 7 to 12' then 3 when answers.Q2='All, and two or more in autonomous or private school' then 13 end + case when answers.Q3='No' then 0 when answers.Q3='Yes, or no female head/spouse' then 3 end + case when answers.Q4='Earth, or other' then 0 when answers.Q4='Wooded planks, tiles or concrete, mud bricks, or cement bricks or tile (mosaic, ceramic, or glazed)' then 7 end + case when answers.Q5='None' then 0 when answers.Q5='Outhouse or latrine (with or without treatment), or flush toilet connected to cesspool, septic tank, river, or stream' then 3 when answers.Q5='Flush toilet connected to sewer' then 7 end + case when answers.Q6='Non-purchased firewood' then 0 when answers.Q6='Purchased firewood' then 2 when answers.Q6='Charcoal, butane or propane gas, kerosene, electricity, other, or does not cook' then 9 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 6 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 4 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 4 end + case when answers.Q10='None' then 0 when answers.Q10='Only radio' then 1 when answers.Q10='Radio/tape player, regardless of radio, and no stereo' then 5 when answers.Q10='Stereo, regardless of radio and radio/tape player' then 10 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_nicaragua_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_nicaragua_2010_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_nicaragua_2010_family_members_7_to_12_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_nicaragua_2010_female_head_literate', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_nicaragua_2010_house_floor', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_nicaragua_2010_toilet_type', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_nicaragua_2010_cooking_fuel', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_nicaragua_2010_has_refrigerator', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_nicaragua_2010_has_blender', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_nicaragua_2010_has_iron', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_nicaragua_2010_has_stereo', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Nicaragua 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Nigeria 2008', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Eight or more' then 0 when answers.Q1='Six or seven' then 6 when answers.Q1='Five' then 11 when answers.Q1='Four' then 14 when answers.Q1='Three' then 19 when answers.Q1='Two' then 30 when answers.Q1='One' then 38 end + case when answers.Q2='Not all' then 0 when answers.Q2='No children ages 6 to 18' then 7 when answers.Q2='All' then 9 end + case when answers.Q3='Earth/mud, or dirt/straw' then 0 when answers.Q3='Wood, tile, plank, concrete, or other' then 4 end + case when answers.Q4='Mud/mud bricks' then 0 when answers.Q4='Thatch (grass or straw)' then 3 when answers.Q4='Wood/bamboo, corrugated iron sheets, cement/concrete, roofing tiles, or other' then 6 end + case when answers.Q5='Unprotected well/rain water, or untreated pipe-borne' then 0 when answers.Q5='Vendor, truck, protected well, river, lake, or pond' then 4 when answers.Q5='Treated pipe-borne water, borehole/hand pump, or other' then 6 end + case when answers.Q6='Pail/bucket, covered or uncovered pit latrine, ventilated improved pit latrine, other, or none' then 0 when answers.Q6='Toilet on water, or flush to sewer or septic tank' then 5 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 15 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 7 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 5 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 5 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_nigeria_2008_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_nigeria_2008_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_nigeria_2008_all_family_members_6_to_18_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_nigeria_2008_house_floors', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_nigeria_2008_house_roof', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_nigeria_2008_water_source', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_nigeria_2008_toilet_type', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_nigeria_2008_owns_television', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_nigeria_2008_owns_stove', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_nigeria_2008_owns_bed', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_nigeria_2008_owns_radio', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Nigeria 2008' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Pakistan 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Balochistan' then 0 when answers.Q1='Northwest Frontier Province' then 9 when answers.Q1='Sindh' then 11 when answers.Q1='Punjab or Islamabad' then 12 end + case when answers.Q2='Five or more' then 0 when answers.Q2='Four' then 6 when answers.Q2='Three' then 11 when answers.Q2='Two' then 15 when answers.Q2='One' then 22 when answers.Q2='None' then 31 end + case when answers.Q3='Not all' then 0 when answers.Q3='All, or no children ages 5 to 13' then 5 end + case when answers.Q4='Two or more' then 0 when answers.Q4='One' then 5 when answers.Q4='None' then 12 end + case when answers.Q5='Less than Class 1 or no data' then 0 when answers.Q5='No female head/spouse' then 4 when answers.Q5='Class 1 or higher' then 6 end + case when answers.Q6='Others' then 0 when answers.Q6='Hand pump, covered/closed well, motorized pump/tube well, or piped water' then 3 end + case when answers.Q7='None or other' then 0 when answers.Q7='Flush connected to pit/septic tank or open drain' then 2 when answers.Q7='Flush connected to public sewerage' then 4 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 12 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 3 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 12 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_pakistan_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_pakistan_2009_province', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_pakistan_2009_family_members_0_to_13', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_pakistan_2009_family_members_5_to_13_in_school', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_pakistan_2009_employed_elementary_work', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_pakistan_2009_female_head_education_level', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_pakistan_2009_water_source', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_pakistan_2009_toilet_type', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_pakistan_2009_owns_refrigerator', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_pakistan_2009_owns_television', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_pakistan_2009_owns_trasportation', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Pakistan 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Palestine 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Ten or more' then 0 when answers.Q1='Nine' then 1 when answers.Q1='Eight' then 6 when answers.Q1='Five, six, or seven' then 9 when answers.Q1='Four' then 21 when answers.Q1='One, two, or three' then 32 end + case when answers.Q2='Cement cob, mud, or other' then 0 when answers.Q2='Cleaned stone, stone and cement, old stone, or concrete' then 8 end + case when answers.Q3='No' then 0 when answers.Q3='Yes' then 2 end + case when answers.Q4='No' then 0 when answers.Q4='Yes' then 10 end + case when answers.Q5='None' then 0 when answers.Q5='Only cellular' then 7 when answers.Q5='Land-line (regardless of cellular)' then 9 end + case when answers.Q6='None' then 0 when answers.Q6='Only T.V.' then 2 when answers.Q6='T.V. and VCR and/or DVD' then 6 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 5 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 10 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 7 end + case when answers.Q10='None' then 0 when answers.Q10='One' then 5 when answers.Q10='Two or more' then 11 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_palestine_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_palestine_2010_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_palestine_2010_house_walls', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_palestine_2010_has_solar_water_heater', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_palestine_2010_has_vacuum', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_palestine_2010_has_phone', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_palestine_2010_has_tv_vcr_dvd', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_palestine_2010_has_satellite_dish', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_palestine_2010_has_computer', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_palestine_2010_has_bookcase', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_palestine_2010_family_members_employed', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Palestine 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Peru 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Four or more' then 0 when answers.Q1='Three' then 5 when answers.Q1='Two' then 9 when answers.Q1='One' then 16 when answers.Q1='None' then 24 end + case when answers.Q2='None, pre-school, or kindergarten' then 0 when answers.Q2='Grade school (incomplete)' then 5 when answers.Q2='Grade school (complete)' then 7 when answers.Q2='High school (incomplete)' then 9 when answers.Q2='High school (complete), non-university superior (incomplete) or no female head' then 10 when answers.Q2='Non-university superior (complete) or higher' then 16 end + case when answers.Q3='Earth, wood planks, other, or no residence' then 0 when answers.Q3='Cement' then 2 when answers.Q3='Parquet, polished wood, linoleum, vinyl, tile, or similar' then 15 end + case when answers.Q4='Adobe, mud, or matting' then 0 when answers.Q4='Wattle and daub, wood, matting, brick or cement blocks, stone blocks with lime or cement, other, or no residence' then 2 end + case when answers.Q5='One' then 0 when answers.Q5='Two' then 1 when answers.Q5='Three, four, or five' then 5 when answers.Q5='Six or more' then 10 end + case when answers.Q6='Other' then 0 when answers.Q6='Firewood, charcoal, or kerosene' then 5 when answers.Q6='Gas (LPG or natural)' then 9 when answers.Q6='Electricity or does not cook' then 16 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 5 end + case when answers.Q8='None' then 0 when answers.Q8='One' then 3 when answers.Q8='Two or more' then 7 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 3 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 2 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_peru_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_peru_2009_family_members_0_to_17', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_peru_2009_female_head_education_level', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_peru_2009_house_floors', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_peru_2009_house_walls', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_peru_2009_house_rooms', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_peru_2009_cooking_fuel', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_peru_2009_has_refrigerator', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_peru_2009_color_televisions', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_peru_2009_has_blender', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_peru_2009_has_iron', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Peru 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Philippines 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Five or more' then 0 when answers.Q1='Four' then 4 when answers.Q1='Three' then 9 when answers.Q1='Two' then 15 when answers.Q1='One' then 20 when answers.Q1='None' then 26 end + case when answers.Q2='No' then 0 when answers.Q2='Yes' then 2 when answers.Q2='No children ages 6 to 14' then 4 end + case when answers.Q3='Graduate primary or less' then 0 when answers.Q3='First- to fourth-year secondary' then 3 when answers.Q3='Graduate secondary' then 6 when answers.Q3='First-year college or higher, or no female head/spouse' then 11 end + case when answers.Q4='No' then 0 when answers.Q4='Yes' then 5 end + case when answers.Q5='Light materials (cogon, nipa, or sawali, bamboo, anahaw)' then 0 when answers.Q5='Strong materials (iron, aluminum, tile, concrete, brick, stone, wood, asbestos)' then 4 end + case when answers.Q6='Light materials (Salvaged, makeshift, cogon, nipa, or anahaw)' then 0 when answers.Q6='Strong materials (Galvanized iron, aluminum tile, concrete, brick, stone, or asbestos)' then 2 end + case when answers.Q7='None, open pit, closed pit, or other' then 0 when answers.Q7='Water sealed' then 7 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 10 end + case when answers.Q9='None' then 0 when answers.Q9='One' then 6 when answers.Q9='Two or more' then 21 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 10 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_philippines_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_philippines_2009_family_members_0_to_14', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_philippines_2009_all_family_members_6_to_14_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_philippines_2009_female_head_education_level', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_philippines_2009_salaried_employment', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_philippines_2009_house_walls', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_philippines_2009_house_roof', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_philippines_2009_toilet_type', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_philippines_2009_owns_refrigerator', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_philippines_2009_televisions', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_philippines_2009_owns_washing_machine', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Philippines 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Romania 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Five or more' then 0 when answers.Q1='Four' then 5 when answers.Q1='Three' then 11 when answers.Q1='Two' then 18 when answers.Q1='One' then 28 end + case when answers.Q2='No formal school, primary (Class 1 - 4), or secondary (Class 5 - 8)' then 0 when answers.Q2='Vocational, complementary, apprenticeship, or lower high school (Class 9-10)' then 2 when answers.Q2='High school (Class 9-12)' then 4 when answers.Q2='Specialty post-high school, technical foreman, or university short-term (college)' then 5 when answers.Q2='University long-term' then 10 end + case when answers.Q3='Own system, not available, or no data' then 0 when answers.Q3='Public system' then 1 end + case when answers.Q4='No land-line, and no mobile' then 0 when answers.Q4='No land-line, but one mobile' then 7 when answers.Q4='One or more land-lines, but no mobile' then 9 when answers.Q4='No land-line, but two or more mobiles' then 13 when answers.Q4='One or more land-lines, and one mobile' then 16 when answers.Q4='One or more land-lines, and two or more mobiles' then 18 end + case when answers.Q5='No' then 0 when answers.Q5='Yes' then 3 end + case when answers.Q6='None' then 0 when answers.Q6='Only non-automatic' then 3 when answers.Q6='Automatic (regardless of owning non-automatic)' then 5 end + case when answers.Q7='None' then 0 when answers.Q7='Refrigerator only or freezer only' then 5 when answers.Q7='Refrigerator and freezer, or refrigerating combine' then 10 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 5 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 2 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 18 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_romania_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_romania_2009_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_romania_2009_education_level', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_romania_2009_sewage_system', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_romania_2009_phones', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_romania_2009_gas_stoves', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_romania_2009_washing_machine_type', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_romania_2009_refrigerator_type', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_romania_2009_owns_color_television', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_romania_2009_owns_radio', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_romania_2009_owns_car', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Romania 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Russia 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Five or more' then 0 when answers.Q1='Four' then 5 when answers.Q1='Three' then 11 when answers.Q1='Two' then 22 when answers.Q1='One' then 35 end + case when answers.Q2='No' then 0 when answers.Q2='Yes' then 5 end + case when answers.Q3='24 or less' then 0 when answers.Q3='25 to 39' then 3 when answers.Q3='40 to 59' then 4 when answers.Q3='60 to 99' then 6 when answers.Q3='100 or more' then 8 end + case when answers.Q4='None' then 0 when answers.Q4='Individual water heater' then 4 when answers.Q4='Centralized' then 6 end + case when answers.Q5='None' then 0 when answers.Q5='One' then 3 when answers.Q5='Two or more' then 7 end + case when answers.Q6='None' then 0 when answers.Q6='One' then 3 when answers.Q6='Two or more' then 7 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 2 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 4 end + case when answers.Q9='None' then 0 when answers.Q9='One or more land-lines, and no cellular' then 6 when answers.Q9='No land-lines, and one cellular' then 10 when answers.Q9='One or more land-lines, and one cellular' then 13 when answers.Q9='No land-lines, and two or more cellular' then 15 when answers.Q9='One or more land-lines, and two cellular' then 16 when answers.Q9='One or more land-lines, and three or more cellular' then 21 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 5 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_russia_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_russia_2010_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_russia_2010_employed_in_highly_skilled_work', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_russia_2010_house_area', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_russia_2010_hot_water_source', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_russia_2010_color_televisions', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_russia_2010_vcrs_and_dvds', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_russia_2010_owns_microwave', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_russia_2010_owns_computer', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_russia_2010_phones', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_russia_2010_owns_car', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Russia 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Senegal 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Autre' then 0 when answers.Q1='Briques en banco ou en ciment' then 11 end + case when answers.Q2='Lampe tempête ou lampe a pétrole artisanale' then 0 when answers.Q2='Bougie, bois ou autre' then 3 when answers.Q2='Groupe électrogene, solaire, lampe à gaz ou électricité (SENELEC)' then 8 end + case when answers.Q3='Autre' then 0 when answers.Q3='Gaz' then 7 end + case when answers.Q4='Autre' then 0 when answers.Q4='Robinet interieur' then 7 end + case when answers.Q5='Latrines non couvertes, cuvette/seau, aucun ou autre' then 0 when answers.Q5='Latrines couvertes, latrines ventilées améliorées ou chasse d\\\'eau avec fosse septique' then 8 when answers.Q5='Chasse d\\\'eau avec égout' then 19 end + case when answers.Q6='Non' then 0 when answers.Q6='Oui' then 19 end + case when answers.Q7='Non' then 0 when answers.Q7='Oui' then 2 end + case when answers.Q8='Non' then 0 when answers.Q8='Oui' then 15 end + case when answers.Q9='Non' then 0 when answers.Q9='Oui' then 5 end + case when answers.Q10='Il n\\\'y a pas chef de famille féminin' then 0 when answers.Q10='Non' then 2 when answers.Q10='Oui' then 7 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_senegal_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_senegal_2009_house_walls', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_senegal_2009_energy_for_lighting', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_senegal_2009_cooking_fuel', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_senegal_2009_water_source', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_senegal_2009_toilet_type', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_senegal_2009_owns_refrigerator', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_senegal_2009_owns_television', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_senegal_2009_owns_fan', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_senegal_2009_owns_iron', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_senegal_2009_female_head_literate', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Senegal 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Sierraleone 2011', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Ten or more' then 0 when answers.Q1='Seven, eight, or nine' then 9 when answers.Q1='Six' then 13 when answers.Q1='Five' then 16 when answers.Q1='Four' then 21 when answers.Q1='One, two, or three' then 28 end + case when answers.Q2='No' then 0 when answers.Q2='Yes, or no one aged 6 to 13' then 5 end + case when answers.Q3='No female head/spouse' then 0 when answers.Q3='Agriculture, forestry, mining, or quarrying' then 3 when answers.Q3='Other, or does not work' then 9 end + case when answers.Q4='One' then 0 when answers.Q4='Two' then 4 when answers.Q4='Three or more' then 7 end + case when answers.Q5='Earth/mud, stone/brick, or other' then 0 when answers.Q5='Wood, or cement/concrete' then 3 end + case when answers.Q6='Stone/burnt bricks, or other' then 0 when answers.Q6='Mud/mud bricks, or wood' then 11 when answers.Q6='Cement/sandcrete, or corrugated iron sheets' then 14 end + case when answers.Q7='Bush/river, none, or other' then 0 when answers.Q7='Bucket, common pit, or VIP' then 1 when answers.Q7='Private pit, common flush, or flush toilet' then 7 end + case when answers.Q8='Generator, kerosene, gas lamp, candles/torch light, or other' then 0 when answers.Q8='Electricity (mains)' then 6 end + case when answers.Q9='Wood, or other' then 0 when answers.Q9='Charcoal' then 4 when answers.Q9='Gas, kerosene, or electricity' then 6 end + case when answers.Q10='None' then 0 when answers.Q10='One' then 4 when answers.Q10='Two or more' then 14 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_sierraleone_2011_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_sierraleone_2011_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_sierraleone_2011_family_members_5_to_13_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_sierraleone_2011_female_head_occupation', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_sierraleone_2011_house_rooms', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_sierraleone_2011_house_floors', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_sierraleone_2011_house_walls', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_sierraleone_2011_toilet_type', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_sierraleone_2011_lighting_fuel', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_sierraleone_2011_cooking_fuel', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_sierraleone_2011_owns_radio', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Sierraleone 2011' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Southafrica 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Seven or more' then 0 when answers.Q1='Six' then 7 when answers.Q1='Five' then 10 when answers.Q1='Four' then 14 when answers.Q1='Three' then 19 when answers.Q1='Two' then 27 when answers.Q1='One' then 37 end + case when answers.Q2='None' then 0 when answers.Q2='One' then 5 when answers.Q2='Two or more' then 10 end + case when answers.Q3='Four or less' then 0 when answers.Q3='Five or six' then 4 when answers.Q3='Seven or more' then 8 end + case when answers.Q4='Bricks, cement block/concrete, corrugated iron/zinc, wood, plastic, cardboard, mixture of mud and cement, wattle and daub, mud, thatching, asbestos, or other' then 0 when answers.Q4='Tile' then 7 end + case when answers.Q5='Pit latrine off-site with or without ventilation pipe, bucket toilet off-site, none, or other' then 0 when answers.Q5='Pit latrine on-site with or without ventilation pipe, or bucket toilet on-site' then 4 when answers.Q5='Flush toilet in dwelling/on-site/off-site with off-site/on-site disposal (septic tank), or chemical toilet on-site or off-site' then 7 end + case when answers.Q6='Paraffin, coal, wood, animal dung, none, or other' then 0 when answers.Q6='Electricity from mains/generator/solar, or gas' then 5 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 9 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 7 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 6 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 4 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_southafrica_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_southafrica_2009_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_southafrica_2009_wage_earners', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_southafrica_2009_house_rooms', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_southafrica_2009_house_roof', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_southafrica_2009_toilet_type', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_southafrica_2009_cooking_fuel', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_southafrica_2009_owns_washing_machine', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_southafrica_2009_owns_vcr_dvd', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_southafrica_2009_owns_microwave', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_southafrica_2009_owns_refrigerator', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Southafrica 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Srilanka 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Six or more' then 0 when answers.Q1='Five' then 6 when answers.Q1='Four' then 10 when answers.Q1='Three' then 17 when answers.Q1='One or two' then 21 end + case when answers.Q2='None' then 0 when answers.Q2='One or more' then 8 end + case when answers.Q3='Year 1 or less' then 0 when answers.Q3='Years 2 to 7' then 1 when answers.Q3='Years 8 or 9' then 4 when answers.Q3='Year 10' then 5 when answers.Q3='No female head/spouse' then 5 when answers.Q3='G.C.E. (O/L) or equivalent, Year 12, or higher' then 13 end + case when answers.Q4='Mud, or other' then 0 when answers.Q4='Cement' then 3 when answers.Q4='Terrazzo/tile' then 9 end + case when answers.Q5='None' then 0 when answers.Q5='One' then 1 when answers.Q5='Two' then 5 when answers.Q5='Three or more' then 7 end + case when answers.Q6='No' then 0 when answers.Q6='Yes' then 9 end + case when answers.Q7='No television' then 0 when answers.Q7='Television, but no VCD/DVD' then 3 when answers.Q7='Television and VCD/DVD' then 7 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 7 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 6 end + case when answers.Q10='None' then 0 when answers.Q10='Bicycle only' then 2 when answers.Q10='Motorcycle etc., but no motor car etc. (regardless of bicycle)' then 9 when answers.Q10='Motorcycle etc. (regardless of bicycle or motor car etc.)' then 13 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_srilanka_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_srilanka_2010_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_srilanka_2010_family_members_employeed_by_government', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_srilanka_2010_female_head_education_level', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_srilanka_2010_house_floors', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_srilanka_2010_house_bedrooms', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_srilanka_2010_owns_fan', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_srilanka_2010_owns_tv_and_dvd', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_srilanka_2010_owns_cooker', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_srilanka_2010_owns_refrigerator', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_srilanka_2010_owns_transportation', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Srilanka 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Syria 2010', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Eight or more' then 0 when answers.Q1='Seven' then 4 when answers.Q1='Six' then 8 when answers.Q1='Five' then 13 when answers.Q1='Four' then 19 when answers.Q1='Three' then 24 when answers.Q1='One or two' then 31 end + case when answers.Q2='Arabic house, or other' then 0 when answers.Q2='Villa, or apartment' then 3 end + case when answers.Q3='One' then 0 when answers.Q3='Two or three' then 9 when answers.Q3='Four' then 12 when answers.Q3='Five or more' then 15 end + case when answers.Q4='No' then 0 when answers.Q4='Yes' then 9 end + case when answers.Q5='No' then 0 when answers.Q5='Yes' then 4 end + case when answers.Q6='None' then 0 when answers.Q6='One' then 3 when answers.Q6='Two' then 5 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 5 end + case when answers.Q8='None' then 0 when answers.Q8='One' then 3 when answers.Q8='Two' then 8 when answers.Q8='Three or more' then 9 end + case when answers.Q9='None' then 0 when answers.Q9='Motorcycle only' then 6 when answers.Q9='Car (regardless of motorcycle)' then 12 end + case when answers.Q10='Farm, or does not work' then 0 when answers.Q10='No male head/spouse' then 2 when answers.Q10='Enterprise, or at home' then 5 when answers.Q10='Other' then 7 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_syria_2010_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_syria_2010_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_syria_2010_residence_type', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_syria_2010_house_rooms', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_syria_2010_has_refrigerator_freezer', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_syria_2010_has_washing_machine', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_syria_2010_bedroom_sets', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_syria_2010_has_chandelier', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_syria_2010_fans', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_syria_2010_owns_motorcycle_car', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_syria_2010_place_of_work', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Syria 2010' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Tanzania 2011', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Four or more' then 0 when answers.Q1='Three' then 8 when answers.Q1='Two' then 15 when answers.Q1='One' then 23 when answers.Q1='None' then 30 end + case when answers.Q2='No' then 0 when answers.Q2='Yes, or no children ages 6 to 17' then 1 end + case when answers.Q3='No' then 0 when answers.Q3='Yes, but not in Kiswahili nor English' then 0 when answers.Q3='No female head/spouse' then 0 when answers.Q3='Yes, only in Kiswahili' then 5 when answers.Q3='Yes, in English (regardless of others)' then 12 end + case when answers.Q4='Earth' then 0 when answers.Q4='Concrete, cement, tiles, timber, or other' then 11 end + case when answers.Q5='Mud and grass' then 0 when answers.Q5='Grass, leaves, bamboo' then 8 when answers.Q5='Concrete, cement, metal sheets (GCI), asbestos sheets, tiles, or other' then 11 end + case when answers.Q6='None' then 0 when answers.Q6='One' then 1 when answers.Q6='Two or more' then 11 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 5 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 6 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 6 end + case when answers.Q10='None' then 0 when answers.Q10='One' then 2 when answers.Q10='Two' then 4 when answers.Q10='Three or more' then 7 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_tanzania_2011_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_tanzania_2011_family_members_0_to_17', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_tanzania_2011_family_members_6_to_17_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_tanzania_2011_female_head_can_read', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_tanzania_2011_house_floor', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_tanzania_2011_house_roof', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_tanzania_2011_bicycles_and_motorcycles', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_tanzania_2011_owns_radio', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_tanzania_2011_owns_lantern', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_tanzania_2011_owns_iron', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_tanzania_2011_tables', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Tanzania 2011' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Timorleste 2007', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Ainaro, Manufahi, or Manatuto' then 0 when answers.Q1='Aileu, Dili, or Ermera' then 6 when answers.Q1='Bobonaro, Cova Lima, Liquiçá, or Oecussi' then 11 when answers.Q1='Baucau, Lautém, and Viqueque' then 23 end + case when answers.Q2='Six or more' then 0 when answers.Q2='Four or five' then 8 when answers.Q2='Three' then 13 when answers.Q2='Two' then 19 when answers.Q2='One' then 29 when answers.Q2='None' then 34 end + case when answers.Q3='No, or no members 8 to 17' then 0 when answers.Q3='Yes' then 3 end + case when answers.Q4='No' then 0 when answers.Q4='Yes' then 3 end + case when answers.Q5='None, pre-school, or primary class 1' then 0 when answers.Q5='Primary class 2 to 5' then 2 when answers.Q5='No male head/spouse' then 3 when answers.Q5='Primary class 6, to pre-secondary class 2' then 5 when answers.Q5='Pre-secondary class 3, or higher' then 7 end + case when answers.Q6='Mud, wood, bamboo, rattan, tin, or other' then 0 when answers.Q6='Brick, concrete, or unbaked brick' then 8 end + case when answers.Q7='Earth/clay, wood, bamboo, or other' then 0 when answers.Q7='Concrete/brick, floor tile/cement, marble/ceramic' then 3 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 4 end + case when answers.Q9='None' then 0 when answers.Q9='One' then 2 when answers.Q9='Two or more' then 4 end + case when answers.Q10='1 to 1,499' then 0 when answers.Q10='1,500 to 2,999' then 3 when answers.Q10='3,000 to 9,999' then 6 when answers.Q10='None' then 6 when answers.Q10='10,000 or more' then 11 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_district', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_family_members_0_to_17', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_family_members_6_to_17_in_school', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_family_members_had_job_last_year', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_male_head_education', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_house_walls', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_house_floors', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_owns_television', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_clothes_cupboards_owned', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_timorleste_2007_land_owned', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Timorleste 2007' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Uganda 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Six or more' then 0 when answers.Q1='Four or five' then 6 when answers.Q1='Three' then 9 when answers.Q1='Two' then 14 when answers.Q1='One' then 27 end + case when answers.Q2='Not all attend' then 0 when answers.Q2='All attend government schools' then 2 when answers.Q2='No children ages 6 to 18' then 4 when answers.Q2='All attend, and one or more attend a private, NGO/religious, or boarding school' then 5 end + case when answers.Q3='No female head/spouse' then 0 when answers.Q3='P.5 or less, or none' then 2 when answers.Q3='P.6' then 6 when answers.Q3='P.7 to S.6' then 8 when answers.Q3='Higher than S.6' then 19 end + case when answers.Q4='Thatch, straw, or other' then 0 when answers.Q4='Iron sheets, or tiles' then 5 end + case when answers.Q5='Un-burnt bricks, mud and poles, thatch/straw. timber, stone, burnt bricks with mud, other' then 0 when answers.Q5='Burnt bricks with cement, or cement blocks' then 2 end + case when answers.Q6='Firewood' then 0 when answers.Q6='Tadooba, or other' then 11 when answers.Q6='Paraffin lantern, or electricity (grid, generator, solar)' then 17 end + case when answers.Q7='Bush (none)' then 0 when answers.Q7='Covered pit latrine (private or shared), VIP latrine (private or shared), uncovered pit latrine, flush toilet (private or shared), or other' then 4 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 7 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 5 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 9 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_family_members_6_to_18_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_female_head_education_level', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_house_roof', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_house_walls', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_lighting_fuel', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_toilet_type', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_owns_electronic_equipment', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_at_least_two_sets_of_clothes', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_uganda_2009_at_least_a_pair_of_shoes', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Uganda 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Vietnam 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Three or more' then 0 when answers.Q1='Two' then 7 when answers.Q1='One' then 16 when answers.Q1='None' then 23 end + case when answers.Q2='Four or more' then 0 when answers.Q2='Two or three' then 6 when answers.Q2='One or none' then 9 end + case when answers.Q3='Makeshift or other' then 0 when answers.Q3='Semi-permanent house' then 1 when answers.Q3='Strong house with a shared kitchen or shared bathroom/toilet' then 2 when answers.Q3='Villa or strong house with a private kitchen and private' then 6 end + case when answers.Q4='None or other' then 0 when answers.Q4='Double-vault compost latrine, or toilet directly over water' then 2 when answers.Q4='Suilabh, or flush toilet with septic tank or sewage pipes' then 7 end + case when answers.Q5='Public tap, deep drilled wells, hand-dug and reinforced/non-reinforced wells, covered wells, protected/unprotected springs, rain, small water tank, water tank, river, lake, pond, or other' then 0 when answers.Q5='Private tap water inside/outside the house, or purchased water (in tank or bottle)' then 4 end + case when answers.Q6='None' then 0 when answers.Q6='Electric cooker, rice cooker, or pressurized cooker (no gas cooker)' then 5 when answers.Q6='Gas cooker' then 16 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 10 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 4 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 10 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 11 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_vietnam_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_vietnam_2009_family_members_0_to_14', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_vietnam_2009_self_employed_agriculture', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_vietnam_2009_residence_type', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_vietnam_2009_toilet_type', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_vietnam_2009_water_source', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_vietnam_2009_cooker_type', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_vietnam_2009_has_motorcycle', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_vietnam_2009_has_video_player', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_vietnam_2009_has_wardrobe', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_vietnam_2009_has_refriderator', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Vietnam 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
insert into dw_ppi_survey (survey_name, scoring_sql) values ('PPI Yemen 2009', "select answers.survey_id, 0 as points_version, date(str_to_date(answers.date_survey_taken, '%d/%m/%Y')) as date_survey_taken, answers.entity_id, answers.entity_type_id, ( case when answers.Q1='Ten or more' then 0 when answers.Q1='Eight or nine' then 8 when answers.Q1='Seven' then 11 when answers.Q1='Six' then 18 when answers.Q1='Four or five' then 21 when answers.Q1='Three' then 26 when answers.Q1='One or two' then 38 end + case when answers.Q2='Not all' then 0 when answers.Q2='All' then 2 when answers.Q2='No children aged 12 to 18' then 8 end + case when answers.Q3='Concrete, mud/soil, stone, or other' then 0 when answers.Q3='Floor tiles or marble' then 15 end + case when answers.Q4='Wood and mud, wood, hay, mud and hay, metal sheets and mud, or other' then 0 when answers.Q4='Reinforced concrete, wood and concrete, or metal sheets' then 4 end + case when answers.Q5='Non-flush toilet, other, or no toilet' then 0 when answers.Q5='Flush toilet' then 5 end + case when answers.Q6='One' then 0 when answers.Q6='Two' then 2 when answers.Q6='Three' then 3 when answers.Q6='Four' then 5 when answers.Q6='Five' then 7 when answers.Q6='Six or more' then 13 end + case when answers.Q7='No' then 0 when answers.Q7='Yes' then 6 end + case when answers.Q8='No' then 0 when answers.Q8='Yes' then 4 end + case when answers.Q9='No' then 0 when answers.Q9='Yes' then 2 end + case when answers.Q10='No' then 0 when answers.Q10='Yes' then 5 end ) as ppi_score from (SELECT qg.id as survey_id, GROUP_CONCAT(if(q.nickname = 'ppi_yemen_2009_survey_date', qgr.response, NULL)) AS 'date_survey_taken', qgi.entity_id as entity_id, es.entity_type_id as entity_type_id, GROUP_CONCAT(if(q.nickname = 'ppi_yemen_2009_family_members', qgr.response, NULL)) AS 'Q1', GROUP_CONCAT(if(q.nickname = 'ppi_yemen_2009_family_members_12_to_18_in_school', qgr.response, NULL)) AS 'Q2', GROUP_CONCAT(if(q.nickname = 'ppi_yemen_2009_house_floors', qgr.response, NULL)) AS 'Q3', GROUP_CONCAT(if(q.nickname = 'ppi_yemen_2009_house_ceiling', qgr.response, NULL)) AS 'Q4', GROUP_CONCAT(if(q.nickname = 'ppi_yemen_2009_toilet_type', qgr.response, NULL)) AS 'Q5', GROUP_CONCAT(if(q.nickname = 'ppi_yemen_2009_house_rooms', qgr.response, NULL)) AS 'Q6', GROUP_CONCAT(if(q.nickname = 'ppi_yemen_2009_owns_television', qgr.response, NULL)) AS 'Q7', GROUP_CONCAT(if(q.nickname = 'ppi_yemen_2009_owns_gas_cylinder', qgr.response, NULL)) AS 'Q8', GROUP_CONCAT(if(q.nickname = 'ppi_yemen_2009_owns_radio', qgr.response, NULL)) AS 'Q9', GROUP_CONCAT(if(q.nickname = 'ppi_yemen_2009_owns_washing_machine', qgr.response, NULL)) AS 'Q10' FROM question_group_response qgr, question_group_instance qgi, question_group qg, sections_questions sq, questions q, event_sources es WHERE qgr.question_group_instance_id = qgi.id and qgr.sections_questions_id = sq.id and sq.question_id = q.question_id and qgi.question_group_id = qg.id and qg.title='PPI Yemen 2009' and qgi.event_source_id = es.id GROUP BY question_group_instance_id) as answers");
